{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = [\"src\", \"alt\"];\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"简介\", -1 /* HOISTED */);\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h3\", null, \"歌单评分\", -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"歌曲列表\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_rate = _resolveComponent(\"el-rate\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", null, [_createElementVNode(\"img\", {\n    src: $data.songDetails.pic,\n    alt: $data.songDetails.title\n  }, null, 8 /* PROPS */, _hoisted_1), _createElementVNode(\"h3\", null, _toDisplayString($data.songDetails.title), 1 /* TEXT */)]), _createElementVNode(\"div\", null, [_hoisted_2, _createElementVNode(\"p\", null, _toDisplayString($data.songDetails.introduction), 1 /* TEXT */)]), _createElementVNode(\"div\", null, [_hoisted_3, _createVNode(_component_el_rate, {\n    modelValue: $data.rank,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.rank = $event),\n    \"allow-half\": \"\",\n    disabled: \"\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"span\", null, _toDisplayString($data.rank * 2), 1 /* TEXT */)]), _createElementVNode(\"div\", null, [_createElementVNode(\"h3\", null, _toDisplayString($data.assistText) + \" \" + _toDisplayString($data.score * 2), 1 /* TEXT */), _createVNode(_component_el_rate, {\n    \"allow-half\": \"\",\n    modelValue: $data.score,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.score = $event),\n    disabled: $data.disabledRank,\n    onClick: $options.pushValue\n  }, null, 8 /* PROPS */, [\"modelValue\", \"disabled\", \"onClick\"])]), _createElementVNode(\"div\", null, [_hoisted_4, _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.currentSongList, song => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: song.id\n    }, _toDisplayString(song.title), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])])]);\n}","map":{"version":3,"names":["_createElementVNode","_createElementBlock","src","$data","songDetails","pic","alt","title","_toDisplayString","_hoisted_2","introduction","_hoisted_3","_createVNode","_component_el_rate","rank","$event","disabled","assistText","score","disabledRank","onClick","$options","pushValue","_hoisted_4","_Fragment","_renderList","currentSongList","song","key","id"],"sources":["E:\\javaideaiu\\class22\\mic\\music-client\\src\\views\\paihangbang.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <img :src=\"songDetails.pic\" :alt=\"songDetails.title\" />\r\n      <h3>{{ songDetails.title }}</h3>\r\n    </div>\r\n    <div>\r\n      <h1>简介</h1>\r\n      <p>{{ songDetails.introduction }}</p>\r\n    </div>\r\n    <div>\r\n      <h3>歌单评分</h3>\r\n      <el-rate v-model=\"rank\" allow-half disabled></el-rate>\r\n      <span>{{ rank * 2 }}</span>\r\n    </div>\r\n    <div>\r\n      <h3>{{ assistText }} {{ score * 2 }}</h3>\r\n      <el-rate allow-half v-model=\"score\" :disabled=\"disabledRank\" @click=\"pushValue\"></el-rate>\r\n    </div>\r\n    <div>\r\n      <h2>歌曲列表</h2>\r\n      <ul>\r\n        <li v-for=\"song in currentSongList\" :key=\"song.id\">{{ song.title }}</li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from \"vue\";\r\nimport { HttpManager } from \"@/api\";\r\n\r\nexport default {\r\n  name: \"SongDetails\",\r\n  data() {\r\n    return {\r\n      songDetails: {},\r\n      rank: 0,\r\n      score: 0,\r\n      disabledRank: false,\r\n      assistText: \"评价\",\r\n      currentSongList: [],\r\n      songListId: \"\",\r\n      userId: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    attachImageUrl() {\r\n      return HttpManager.attachImageUrl;\r\n    },\r\n  },\r\n  methods: {\r\n    async getSongDetails() {\r\n      // 获取歌单信息\r\n      const songDetails = await HttpManager.getSongListDetails(this.songListId);\r\n      this.songDetails = songDetails.data;\r\n\r\n      // 获取歌单评分\r\n      const rank = await HttpManager.getRankOfSongListId(this.songListId);\r\n      this.rank = rank.data / 2;\r\n\r\n      // 获取用户评分\r\n      const userRank = await HttpManager.getUserRank(this.userId, this.songListId);\r\n      if (userRank.data) {\r\n        this.score = userRank.data / 2;\r\n        this.disabledRank = true;\r\n        this.assistText = \"已评价\";\r\n      }\r\n    },\r\n    async pushValue() {\r\n      if (this.disabledRank) return;\r\n\r\n      const params = new URLSearchParams();\r\n      params.append(\"songListId\", this.songListId);\r\n      params.append(\"consumerId\", this.userId);\r\n      params.append(\"score\", (this.score * 2).toString());\r\n\r\n      try {\r\n        const result = await HttpManager.setRank(params);\r\n        // 处理结果\r\n        if (result.success) {\r\n          this.getRank(this.songListId);\r\n          this.disabledRank = true;\r\n          this.assistText = \"已评价\";\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    },\r\n  },\r\n  async mounted() {\r\n    this.songListId = \"your_song_list_id\";\r\n    this.userId = \"your_user_id\";\r\n    await this.getSongDetails();\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n/* 样式省略，根据需要自行添加样式 */\r\n</style>\r\n"],"mappings":";;gCAOMA,mBAAA,CAAW,YAAP,IAAE;gCAINA,mBAAA,CAAa,YAAT,MAAI;gCASRA,mBAAA,CAAa,YAAT,MAAI;;;;uBAnBZC,mBAAA,CAwBM,cAvBJD,mBAAA,CAGM,cAFJA,mBAAA,CAAuD;IAAjDE,GAAG,EAAEC,KAAA,CAAAC,WAAW,CAACC,GAAG;IAAGC,GAAG,EAAEH,KAAA,CAAAC,WAAW,CAACG;uCAC9CP,mBAAA,CAAgC,YAAAQ,gBAAA,CAAzBL,KAAA,CAAAC,WAAW,CAACG,KAAK,iB,GAE1BP,mBAAA,CAGM,cAFJS,UAAW,EACXT,mBAAA,CAAqC,WAAAQ,gBAAA,CAA/BL,KAAA,CAAAC,WAAW,CAACM,YAAY,iB,GAEhCV,mBAAA,CAIM,cAHJW,UAAa,EACbC,YAAA,CAAsDC,kBAAA;gBAApCV,KAAA,CAAAW,IAAI;+DAAJX,KAAA,CAAAW,IAAI,GAAAC,MAAA;IAAE,YAAU,EAAV,EAAU;IAACC,QAAQ,EAAR;2CACnChB,mBAAA,CAA2B,cAAAQ,gBAAA,CAAlBL,KAAA,CAAAW,IAAI,qB,GAEfd,mBAAA,CAGM,cAFJA,mBAAA,CAAyC,YAAAQ,gBAAA,CAAlCL,KAAA,CAAAc,UAAU,IAAG,GAAC,GAAAT,gBAAA,CAAGL,KAAA,CAAAe,KAAK,sBAC7BN,YAAA,CAA0FC,kBAAA;IAAjF,YAAU,EAAV,EAAU;gBAAUV,KAAA,CAAAe,KAAK;+DAALf,KAAA,CAAAe,KAAK,GAAAH,MAAA;IAAGC,QAAQ,EAAEb,KAAA,CAAAgB,YAAY;IAAGC,OAAK,EAAEC,QAAA,CAAAC;oEAEvEtB,mBAAA,CAKM,cAJJuB,UAAa,EACbvB,mBAAA,CAEK,c,kBADHC,mBAAA,CAAwEuB,SAAA,QAAAC,WAAA,CAArDtB,KAAA,CAAAuB,eAAe,EAAvBC,IAAI;yBAAf1B,mBAAA,CAAwE;MAAnC2B,GAAG,EAAED,IAAI,CAACE;wBAAOF,IAAI,CAACpB,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}