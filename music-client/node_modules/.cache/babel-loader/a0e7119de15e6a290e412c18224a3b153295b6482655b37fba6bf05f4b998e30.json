{"ast":null,"code":"import \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, onMounted } from \"vue\";\nimport { HttpManager } from \"@/api\";\nexport default {\n  name: \"SongList\",\n  data() {\n    return {\n      songs: []\n    };\n  },\n  methods: {\n    async getSongList() {\n      // 模拟获取歌曲列表\n      const songList = await HttpManager.getSongList();\n      this.songs = songList.data.map(song => ({\n        ...song,\n        rank: 0,\n        score: 0,\n        disabledRank: false,\n        assistText: \"评价\"\n      }));\n    },\n    async pushValue(index) {\n      const song = this.songs[index];\n      if (song.disabledRank) return;\n      const params = new URLSearchParams();\n      params.append(\"songId\", song.id);\n      params.append(\"score\", (song.score * 2).toString());\n      try {\n        const result = await HttpManager.setRank(params);\n        // 处理结果\n        if (result.success) {\n          song.rank = (await HttpManager.getRankOfSongId(song.id)) / 2;\n          song.disabledRank = true;\n          song.assistText = \"已评价\";\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  },\n  async mounted() {\n    await this.getSongList();\n  }\n};","map":{"version":3,"names":["ref","onMounted","HttpManager","name","data","songs","methods","getSongList","songList","map","song","rank","score","disabledRank","assistText","pushValue","index","params","URLSearchParams","append","id","toString","result","setRank","success","getRankOfSongId","error","console","mounted"],"sources":["E:\\javaideaiu\\class22\\mic\\music-client\\src\\views\\paihangbang.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h1>歌曲列表</h1>\r\n    <ul>\r\n      <li v-for=\"(song, index) in songs\" :key=\"index\">\r\n        <h3>{{ song.title }}</h3>\r\n        <div>\r\n          <h4>歌曲评分</h4>\r\n          <el-rate v-model=\"song.rank\" allow-half disabled></el-rate>\r\n          <span>{{ song.rank * 2 }}</span>\r\n        </div>\r\n        <div>\r\n          <h4>{{ song.assistText }} {{ song.score * 2 }}</h4>\r\n          <el-rate allow-half v-model=\"song.score\" :disabled=\"song.disabledRank\" @click=\"pushValue(index)\"></el-rate>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from \"vue\";\r\nimport { HttpManager } from \"@/api\";\r\n\r\nexport default {\r\n  name: \"SongList\",\r\n  data() {\r\n    return {\r\n      songs: [],\r\n    };\r\n  },\r\n  methods: {\r\n    async getSongList() {\r\n      // 模拟获取歌曲列表\r\n      const songList = await HttpManager.getSongList();\r\n      this.songs = songList.data.map((song) => ({\r\n        ...song,\r\n        rank: 0,\r\n        score: 0,\r\n        disabledRank: false,\r\n        assistText: \"评价\",\r\n      }));\r\n    },\r\n    async pushValue(index) {\r\n      const song = this.songs[index];\r\n      if (song.disabledRank) return;\r\n\r\n      const params = new URLSearchParams();\r\n      params.append(\"songId\", song.id);\r\n      params.append(\"score\", (song.score * 2).toString());\r\n\r\n      try {\r\n        const result = await HttpManager.setRank(params);\r\n        // 处理结果\r\n        if (result.success) {\r\n          song.rank = await HttpManager.getRankOfSongId(song.id) / 2;\r\n          song.disabledRank = true;\r\n          song.assistText = \"已评价\";\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    },\r\n  },\r\n  async mounted() {\r\n    await this.getSongList();\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n/* 样式省略，根据需要自行添加样式 */\r\n</style>\r\n"],"mappings":";AAqBA,SAASA,GAAG,EAAEC,SAAQ,QAAS,KAAK;AACpC,SAASC,WAAU,QAAS,OAAO;AAEnC,eAAe;EACbC,IAAI,EAAE,UAAU;EAChBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE;IACT,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,WAAWA,CAAA,EAAG;MAClB;MACA,MAAMC,QAAO,GAAI,MAAMN,WAAW,CAACK,WAAW,CAAC,CAAC;MAChD,IAAI,CAACF,KAAI,GAAIG,QAAQ,CAACJ,IAAI,CAACK,GAAG,CAAEC,IAAI,KAAM;QACxC,GAAGA,IAAI;QACPC,IAAI,EAAE,CAAC;QACPC,KAAK,EAAE,CAAC;QACRC,YAAY,EAAE,KAAK;QACnBC,UAAU,EAAE;MACd,CAAC,CAAC,CAAC;IACL,CAAC;IACD,MAAMC,SAASA,CAACC,KAAK,EAAE;MACrB,MAAMN,IAAG,GAAI,IAAI,CAACL,KAAK,CAACW,KAAK,CAAC;MAC9B,IAAIN,IAAI,CAACG,YAAY,EAAE;MAEvB,MAAMI,MAAK,GAAI,IAAIC,eAAe,CAAC,CAAC;MACpCD,MAAM,CAACE,MAAM,CAAC,QAAQ,EAAET,IAAI,CAACU,EAAE,CAAC;MAChCH,MAAM,CAACE,MAAM,CAAC,OAAO,EAAE,CAACT,IAAI,CAACE,KAAI,GAAI,CAAC,EAAES,QAAQ,CAAC,CAAC,CAAC;MAEnD,IAAI;QACF,MAAMC,MAAK,GAAI,MAAMpB,WAAW,CAACqB,OAAO,CAACN,MAAM,CAAC;QAChD;QACA,IAAIK,MAAM,CAACE,OAAO,EAAE;UAClBd,IAAI,CAACC,IAAG,GAAI,OAAMT,WAAW,CAACuB,eAAe,CAACf,IAAI,CAACU,EAAE,KAAI,CAAC;UAC1DV,IAAI,CAACG,YAAW,GAAI,IAAI;UACxBH,IAAI,CAACI,UAAS,GAAI,KAAK;QACzB;MACF,EAAE,OAAOY,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACtB;IACF;EACF,CAAC;EACD,MAAME,OAAOA,CAAA,EAAG;IACd,MAAM,IAAI,CAACrB,WAAW,CAAC,CAAC;EAC1B;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}